---
id: slri4
title: The origin
file_version: 1.1.2
app_version: 1.4.6
---

This line is the place where all the catastrophic happened.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ packages/common/src/index.ts
```typescript
12     export * from "typescript";
```

<br/>

Why? Before ts-morph-pnp, there was no solution for ts-morph with yarn pnp. Because TypeScript Compiler API is unstable, ts-morph decided to embrace all the Compiler API code base to its bundled result. But it turns out that this approach cannot gracefully come together with yarn pnp API.

pnp API, which is a brand new (but already wide-spread) module resolving algorithm, is powered by patching `module` module of node. It hooks up the module request and find the dedicate module in .yarn/cache, which is the yarn version of node\_modules.

So what about TypeScript? Well, TypeScript is not support yarn natively yet. But what makes yarn team wonderful is that they go ahead by merging the proposal of TypeScript yarn pnp support, and embed it as yarn plugin and by default. It means yarn support TypeScript (not the opposite direction) out of box!

What makes us sad is that the pnp support of TypeScript can be made only if the typescript module request is go through yarn loader, with exact name "typescript". ts-morph is resolving typescript as internal dependency with relative path, so there is no chance for yarn to manipulate TypeScript as pnp compatible.

See this line.

<br/>

This is a devDependency of ts-morph, the main package of ts-morph. You can see the typescript is in this list. Besides (see next code snippet)
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ packages/ts-morph/package.json
```json
50       "devDependencies": {
51         "@types/chai": "^4.3.1",
52         "@types/diff": "^5.0.2",
53         "@types/mocha": "^9.1.1",
54         "@types/node": "^17.0.39",
55         "chai": "^4.3.6",
56         "conditional-type-checks": "^1.0.5",
57         "cross-env": "^7.0.3",
58         "diff": "^5.1.0",
59         "mocha": "10.0.0",
60         "rimraf": "^3.0.2",
61         "rollup": "^2.75.5",
62         "rollup-plugin-typescript2": "^0.32.0",
63         "ts-node": "10.8.1",
64         "typescript": "~4.7.3"
65       },
```

<br/>

In dependencies, there is no typescript. This imposes that maybe typescript is peer dependency, or ts-morph serves typescript manually (by bundling the Compiler API).
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ packages/ts-morph/package.json
```json
46       "dependencies": {
47         "@ts-morph/common": "~0.16.0",
48         "code-block-writer": "^11.0.0"
49       },
```

<br/>

The let's see the peerDeps. What's in there? Nothing! Actually there's no peer dependencies at all.

<br/>

<br/>

This file was generated by Swimm. [Click here to view it in the app](/repos/Z2l0aHViJTNBJTNBdHMtbW9ycGgtcG5wJTNBJTNBandvbzAxMjI=/docs/slri4).
